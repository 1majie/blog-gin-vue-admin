/**
 * name: vite-plugin-banner
 * version: v0.7.1
 * author: chengpeiquan <chengpeiquan@chengpeiquan.com>
 * repo: https://github.com/chengpeiquan/vite-plugin-banner
 */
import t from"fs";import{resolve as n}from"path";let e;const o=new RegExp(/\.(css|[mc]?js)$/i),r=new RegExp(/vendor/);function i(i){const c=function(t){const n={content:"",outDir:"dist",debug:!1,verify:!0},e=Object.prototype.toString.call(t);if(!["[object String]","[object Object]","[object Function]"].includes(e))throw new Error("[vite-plugin-banner] The options must be a string, an object or a function.");if("string"==typeof t&&(n.content=t),"function"==typeof t)return n.content=t,n;if("object"==typeof t){if(!Object.prototype.hasOwnProperty.call(t,"content"))throw new Error('[vite-plugin-banner] Missing "content" option.');n.content=t.content,Object.prototype.hasOwnProperty.call(t,"outDir")&&"string"==typeof t.outDir&&(n.outDir=t.outDir),n.debug=Boolean(t.debug),"boolean"==typeof t.verify&&(n.verify=t.verify)}if(!n.verify)return n;if("function"==typeof n.content)return n;const o="string"!=typeof(r=n.content)?"The banner content must be a string.":r?r.includes("/*")&&!r.includes("*/")||!r.includes("/*")&&r.includes("*/")?"If you want to pass in comment symbols, you must pass them in pairs.":"":"The banner content can not be empty.";var r;if(o)throw new Error(`[vite-plugin-banner] ${o}`);return n}(i);return{name:"banner",configResolved(t){e=t},async writeBundle(i,s){for(const i of Object.entries(s)){const s=e.root,u=c.outDir||e.build.outDir||"dist",f=i[0].endsWith(".js-lean")?i[0].replace(/\.js-lean/,".lean.js"):i[0],a=n(s,u,f),{content:l}=c;if(o.test(f)&&!r.test(f))try{let n=t.readFileSync(a,{encoding:"utf8"}),e="string"==typeof l?l:"";"function"==typeof l&&(e=l(f)),e&&(n=e.includes("/*")||e.includes("*/")||!c.verify?`${e}\n${n}`:`/*! ${e} */\n${n}`),t.writeFileSync(a,n)}catch(t){c.debug&&console.log(t)}}}}}export{i as default};
